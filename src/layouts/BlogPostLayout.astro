---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_NAME } from "../data/site";

const { frontmatter } = Astro.props;
const { title, description, pubDate, updatedDate, author, image, tags } = frontmatter;

// Format dates
const formattedPubDate = new Date(pubDate).toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
  day: "numeric",
});

const formattedUpdatedDate = updatedDate
  ? new Date(updatedDate).toLocaleDateString("en-US", {
      year: "numeric",
      month: "long",
      day: "numeric",
    })
  : null;
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={`${title} - ${SITE_NAME}`} description={description} image={image || "/images/og-default.jpg"} />
  </head>
  <body>
    <Header />

    <article id="main-content" class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <!-- Article Header -->
          <header class="mb-5">
            <h1 class="display-4 fw-bold mb-3">{title}</h1>

            <div class="text-muted mb-3">
              <span class="me-3">
                <i class="bi bi-person-circle me-1"></i>
                {author}
              </span>
              <span class="me-3">
                <i class="bi bi-calendar3 me-1"></i>
                <time datetime={pubDate.toISOString()}>{formattedPubDate}</time>
              </span>
              {
                formattedUpdatedDate && (
                  <span>
                    <i class="bi bi-arrow-repeat me-1" />
                    Updated: {formattedUpdatedDate}
                  </span>
                )
              }
            </div>

            {
              tags && tags.length > 0 && (
                <div class="mb-4">
                  {tags.map((tag: string) => (
                    <a href={`/blog/tags/${tag}`} class="badge bg-primary text-decoration-none me-2">
                      {tag}
                    </a>
                  ))}
                </div>
              )
            }

            <p class="lead">{description}</p>
          </header>

          <!-- Article Content -->
          <div class="prose">
            <slot />
          </div>

          <!-- Article Footer -->
          <footer class="mt-5 pt-4 border-top">
            <div class="d-flex justify-content-between align-items-center">
              <a href="/blog" class="btn btn-outline-primary">
                <i class="bi bi-arrow-left me-2"></i>
                Back to Blog
              </a>

              <div>
                <span class="text-muted">Share:</span>
                <a href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${Astro.url.href}`} class="btn btn-sm btn-outline-secondary ms-2" target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter">
                  <i class="bi bi-twitter"></i>
                </a>
                <a href={`https://www.facebook.com/sharer/sharer.php?u=${Astro.url.href}`} class="btn btn-sm btn-outline-secondary ms-2" target="_blank" rel="noopener noreferrer" aria-label="Share on Facebook">
                  <i class="bi bi-facebook"></i>
                </a>
              </div>
            </div>
          </footer>
        </div>
      </div>
    </article>

    <Footer />
  </body>
</html>

<style>
  /* Prose styles for blog content */
  .prose {
    font-size: 1.125rem;
    line-height: 1.75;
  }

  .prose h2 {
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-weight: 700;
  }

  .prose h3 {
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  .prose p {
    margin-bottom: 1.25rem;
  }

  .prose ul,
  .prose ol {
    margin-bottom: 1.25rem;
    padding-left: 1.5rem;
  }

  .prose li {
    margin-bottom: 0.5rem;
  }

  .prose a {
    color: var(--bs-primary);
    text-decoration: underline;
  }

  .prose a:hover {
    color: var(--bs-primary);
    text-decoration: none;
  }

  .prose hr {
    margin: 2rem 0;
  }

  .prose blockquote {
    border-left: 4px solid var(--bs-primary);
    padding-left: 1rem;
    margin-left: 0;
    font-style: italic;
    color: var(--bs-secondary);
  }
</style>
